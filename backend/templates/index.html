<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Demo Notifications & Heartbeat</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { color: #003056; }
    form { margin-bottom: 30px; }
    label { display: block; margin-top: 10px; }
    input[type="text"], textarea, select { width: 300px; padding: 5px; }
    button { margin-top: 10px; padding: 10px 20px; background-color: #FF5C00; color: white; border: none; }
    table { border-collapse: collapse; width: 80%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    th { background-color: #f2f2f2; }
  </style>
</head>
<body>
  <h1>Demo Notifications & Heartbeat Status</h1>

  <h2>Server Heartbeat: <span style="color:green;">{{ heartbeat_status }}</span></h2>

  <h2>Send a Demo Notification</h2>
  <form method="POST" action="{{ url_for('send_notification') }}">
    <label for="target">Target:</label>
    <select name="target" id="target" onchange="toggleUserInput(this.value)">
      <option value="all">All Users</option>
      <option value="selected">Selected User</option>
    </select>

    <div id="userInput" style="display:none;">
      <label for="username">Username (for selected user):</label>
      <input type="text" name="username" id="username" placeholder="Enter username">
    </div>

    <label for="title">Notification Title:</label>
    <input type="text" name="title" id="title" placeholder="Enter title">

    <label for="body">Notification Message:</label>
    <textarea name="body" id="body" rows="4" placeholder="Enter message"></textarea>

    <br>
    <button type="submit">Send Notification</button>
  </form>

  <h2>Current Open Tasks</h2>
  {% if open_tasks|length == 0 %}
    <p>No open tasks.</p>
  {% else %}
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Title</th>
          <th>Creation Date</th>
          <th>Due Date</th>
        </tr>
      </thead>
      <tbody>
        {% for task in open_tasks %}
          <tr>
            <td>{{ task['id'] }}</td>
            <td>{{ task['title'] }}</td>
            <td>{{ task['creation_date'] }}</td>
            <td>{{ task['due_date'] }}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% endif %}

  <script>
    function toggleUserInput(value) {
      document.getElementById('userInput').style.display = (value === 'selected') ? 'block' : 'none';
    }
  </script>
</body>
</html>
